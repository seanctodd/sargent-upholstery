{{- $src := .Get "src" -}}
{{- $alt := .Get "alt" | default "" -}}
{{- $loading := .Get "loading" | default "lazy" -}}
{{- $img := resources.Get $src -}}
{{- if $img -}}
  {{- $sm := $img.Resize "640x webp q80" -}}
  {{- $md := $img.Resize "1024x webp q80" -}}
  {{- $lg := $img.Resize "1400x webp q85" -}}
<img src="{{ $sm.RelPermalink }}"
  srcset="{{ $sm.RelPermalink }} 640w, {{ $md.RelPermalink }} 1024w, {{ $lg.RelPermalink }} 1400w"
  sizes="(max-width: 768px) 100vw, 50vw"
  alt="{{ $alt }}"
  loading="{{ $loading }}"
  width="{{ $sm.Width }}" height="{{ $sm.Height }}">
{{- else -}}
<img src="{{ $src | relURL }}" alt="{{ $alt }}" loading="{{ $loading }}">
{{- end -}}